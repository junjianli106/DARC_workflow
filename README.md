
# 自监督结直肠癌分类工作流

## 简介
本工作流专注于结直肠癌病理图像的分类任务，基于DARC算法的高效模型，能够快速、精准地完成组织分类。该工作流适合应用于复杂病理场景中，为病理诊断和研究提供技术支持。

### 核心特性
- **分类对象**：涵盖9类组织，包括：
  1. 脂肪组织  
  2. 背景  
  3. 结直肠癌组织  
  4. 碎屑  
  5. 淋巴细胞  
  6. 黏液组织  
  7. 平滑肌组织  
  8. 正常结肠粘膜  
  9. 肿瘤相关间质组织
- **分类性能**：
  - **分类精度**：96.71%（在测试集CRC-HE-7K上评估）
  - **运行效率**：平均每秒处理528张图像
- **适用场景**：大规模病理图像分类分析和临床辅助诊断。

---

## 环境要求
### 硬件环境
- **CPU**: Intel(R) Xeon(R) Gold 6230 @ 2.10GHz  
- **内存**: 256GB  
- **GPU**: NVIDIA GeForce GTX 2080 Ti  
- **存储**: 1TB HDD  

### 软件环境
- **Python**: 3.7  
- **Pytorch**: 1.7.1  
- **Torchvision**: 0.8.2  
- **Nextflow**: 24.10.1  

---

## 数据说明
### 输入数据
- 测试图像文件夹：`test_data1`
- 数据预处理：图像已完成标准化裁剪，确保分类任务的一致性。

### 输出结果
- 分类结果文件：`result.txt`  
- 内容格式：每行包含图像文件名及其预测类别。

---

## 快速开始
### 环境安装（如果直接有安装pytorch的环境，可以忽略这一步）
1. 创建并激活Python虚拟环境：
   ```bash
   conda create -n DARC python=3.7
   conda activate DARC
   ```
2. 安装依赖：
   ```bash
   pip install torch==1.7.1 torchvision==0.8.2 torchaudio==0.7.2
   pip install -r requirements.txt
   ```

### 运行流程
1. **准备数据**：将待分类的病理图像放入`test_data1`文件夹。
2. **启动推理**：
   - 使用Nextflow执行工作流：
     ```bash
     nextflow run main.nf
     ```
   - 或直接运行Python脚本（建议）：
     ```bash
     python test.py
     ```
3. **查看结果**：分类结果存储在`result.txt`文件中，执行以下命令即可查看：
   ```bash
   cat result.txt
   ```

---

## 测试数据集
- **数据集名称**：CRC-HE-7K  
- **数据规模**：7180张组织病理图像  
- **分类类别**：9类组织  
- **实验结果**：分类准确率96.71%。

---
